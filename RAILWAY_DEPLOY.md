# Деплой Nomad Route в Railway

## Подготовка к деплою

### 1. Настройка репозитория
Убедитесь, что все изменения отправлены в ваш GitHub репозиторий:
```bash
git add .
git commit -m "Подготовка к деплою в Railway"
git push origin main
```

### 2. Создание аккаунта Railway
1. Перейдите на [railway.app](https://railway.app)
2. Войдите через GitHub аккаунт
3. Подтвердите доступ к вашим репозиториям

## Шаги деплоя

### 1. Создание проекта в Railway
1. В панели Railway нажмите "New Project"
2. Выберите "Deploy from GitHub repo"
3. Найдите и выберите ваш репозиторий с проектом
4. Railway автоматически определит, что это Node.js проект

### 2. Настройка базы данных PostgreSQL
1. В проекте нажмите "Add Service"
2. Выберите "Database" → "PostgreSQL"
3. Railway автоматически создаст базу данных
4. Переменная `DATABASE_URL` будет доступна автоматически

### 3. Настройка переменных окружения
В разделе "Variables" добавьте следующие переменные:

**Обязательные:**
- `NODE_ENV=production`
- `JWT_SECRET=ваш_супер_секретный_ключ_для_jwt`
- `CLIENT_URL=https://ваш-домен.up.railway.app` (заполните после деплоя)

**Для email (если используете):**
- `SMTP_HOST=smtp.gmail.com`
- `SMTP_PORT=587`
- `SMTP_USER=ваш_email@gmail.com`
- `SMTP_PASS=ваш_пароль_приложения`

**Для Gemini AI (если используете):**
- `GEMINI_API_KEY=ваш_ключ_gemini`

### 4. Настройка домена
1. После успешного деплоя Railway предоставит домен
2. Скопируйте домен и обновите переменную `CLIENT_URL`
3. Проект автоматически передеплоится

## Проверка деплоя

### 1. Мониторинг логов
- В панели Railway перейдите в раздел "Deployments"
- Проверьте логи сборки и запуска

### 2. Проверка работы приложения
- Откройте ваш домен в браузере
- Проверьте основные функции:
  - Регистрация/вход пользователей
  - Просмотр туров
  - API эндпоинты

### 3. Проверка базы данных
- В Railway откройте сервис PostgreSQL
- Можете подключиться через предоставленные credentials

## Возможные проблемы и решения

### Ошибка сборки
- Проверьте логи сборки в Railway
- Убедитесь, что все зависимости указаны в package.json
- Проверьте версии Node.js (используйте LTS)

### Ошибки базы данных
- Убедитесь, что база данных создана и доступна
- Проверьте правильность переменной DATABASE_URL
- При необходимости выполните миграции

### CORS ошибки
- Убедитесь, что CLIENT_URL правильно настроен
- Проверьте настройки CORS в server/app.js

### Загрузка файлов
- Railway предоставляет ephemeral storage
- Для постоянного хранения файлов рассмотрите использование:
  - Cloudinary для изображений
  - AWS S3 для файлов

## Дополнительные настройки

### Custom Domain
1. В настройках проекта выберите "Custom Domain"
2. Добавьте ваш домен
3. Настройте DNS записи согласно инструкциям Railway

### Мониторинг
- Railway предоставляет базовый мониторинг
- Для расширенного мониторинга используйте внешние сервисы

### Масштабирование
- Railway автоматически масштабирует приложение
- При необходимости можно настроить лимиты ресурсов

## Полезные команды для локальной разработки

```bash
# Установка всех зависимостей
npm run install-all

# Запуск в режиме разработки
npm run dev-server  # Запуск backend
npm run dev-client  # Запуск frontend (в другом терминале)

# Сборка для продакшена
npm run build

# Запуск в продакшене (локально)
npm start
```

## Поддержка
- Railway Documentation: https://docs.railway.app
- Railway Discord: https://discord.gg/railway
- GitHub Issues: создайте issue в вашем репозитории 